# Load required library
library(ggplot2)
setwd("~/Downloads/ML-analysis-olfaction/Figure3/")
# 1. Read the CSV file (replace with your actual file path)
data <- read.csv("c9_young_tb_correl_3.csv")
# 3. Correlation test between column 'a' and 'b'
cor_result <- cor.test(data$Manual, data$ML, method = "pearson")
# Compute R-squared
r2_value <- cor_result$estimate^2
p <- cor_result$p.value
p_text <- if (p < 0.0001) {
"p < 0.0001"
} else if (p < 0.001) {
"p < 0.001"
} else if (p < 0.01) {
"p < 0.01"
} else if (p < 0.05) {
"p < 0.05"
} else {
paste0("p = ", signif(p, 3))
}
# Show result
cat("r =", round(cor_result$estimate, 3), ",", p_text)
# Create plot
pcorrelation <- ggplot(data, aes(x = Manual, y = ML)) +
geom_point(color = "steelblue", size = 2, alpha = 0.5) +
geom_smooth(method = "lm", se = TRUE, color = "darkred", linetype = "dashed") +
theme_minimal() +
theme(
axis.title.x = element_text(size = 7),
axis.title.y = element_text(size = 7)
) +
labs(
title = "Correlation Between Manual and ML Video Analysis",
subtitle = paste0(
"Pearson r = ", round(cor_result$estimate, 2),
", R² = ", round(r2_value, 2),
", ", p_text
),
x = "Manual (time sniffing at each cotton bud presentation - s)",
y = "ML (time sniffing at each cotton bud presentation - s)"
)
ggsave("tb_c9_young_correl_corr_labels_3_r2.tiff", plot = pcorrelation, width = 5, height = 3, dpi = 600)  # Adjust width, height, and dpi as needed and save the image in the folder where the code file is
# 1. Read the CSV file (replace with your actual file path)
data <- read.csv("c9_old_tb_correl_3.csv")
# 3. Correlation test between column 'a' and 'b'
cor_result <- cor.test(data$Manual, data$ML, method = "pearson")
# Compute R-squared
r2_value <- cor_result$estimate^2
p <- cor_result$p.value
p_text <- if (p < 0.0001) {
"p < 0.0001"
} else if (p < 0.001) {
"p < 0.001"
} else if (p < 0.01) {
"p < 0.01"
} else if (p < 0.05) {
"p < 0.05"
} else {
paste0("p = ", signif(p, 3))
}
# Show result
cat("r =", round(cor_result$estimate, 3), ",", p_text)
# Create plot
pcorrelation <- ggplot(data, aes(x = Manual, y = ML)) +
geom_point(color = "steelblue", size = 2, alpha = 0.5) +
geom_smooth(method = "lm", se = TRUE, color = "darkred", linetype = "dashed") +
theme_minimal() +
theme(
axis.title.x = element_text(size = 7),
axis.title.y = element_text(size = 7)
) +
labs(
title = "Correlation Between Manual and ML Video Analysis",
subtitle = paste0(
"Pearson r = ", round(cor_result$estimate, 2),
", R² = ", round(r2_value, 2),
", ", p_text
),
x = "Manual (time sniffing at each cotton bud presentation - s)",
y = "ML (time sniffing at each cotton bud presentation - s)"
)
ggsave("tb_c9_old_correl_corr_labels_3_r2.tiff", plot = pcorrelation, width = 5, height = 3, dpi = 600)  # Adjust width, height, and dpi as needed and save the image in the folder where the code file is
# 1. Read the CSV file (replace with your actual file path)
data <- read.csv("tdp_young_tb_correl_3.csv")
# 3. Correlation test between column 'a' and 'b'
cor_result <- cor.test(data$Manual, data$ML, method = "pearson")
# Compute R-squared
r2_value <- cor_result$estimate^2
p <- cor_result$p.value
p_text <- if (p < 0.0001) {
"p < 0.0001"
} else if (p < 0.001) {
"p < 0.001"
} else if (p < 0.01) {
"p < 0.01"
} else if (p < 0.05) {
"p < 0.05"
} else {
paste0("p = ", signif(p, 3))
}
# Show result
cat("r =", round(cor_result$estimate, 3), ",", p_text)
# Create plot
pcorrelation <- ggplot(data, aes(x = Manual, y = ML)) +
geom_point(color = "steelblue", size = 2, alpha = 0.5) +
geom_smooth(method = "lm", se = TRUE, color = "darkred", linetype = "dashed") +
theme_minimal() +
theme(
axis.title.x = element_text(size = 7),
axis.title.y = element_text(size = 7)
) +
labs(
title = "Correlation Between Manual and ML Video Analysis",
subtitle = paste0(
"Pearson r = ", round(cor_result$estimate, 2),
", R² = ", round(r2_value, 2),
", ", p_text
),
x = "Manual (time sniffing at each cotton bud presentation - s)",
y = "ML (time sniffing at each cotton bud presentation - s)"
)
ggsave("tb_tdp_young_correl_corr_labels_3_r2.tiff", plot = pcorrelation, width = 5, height = 3, dpi = 600)  # Adjust width, height, and dpi as needed and save the image in the folder where the code file is
# 1. Read the CSV file (replace with your actual file path)
data <- read.csv("tdp_old_tb_correl_3.csv")
# 3. Correlation test between column 'a' and 'b'
cor_result <- cor.test(data$Manual, data$ML, method = "pearson")
# Compute R-squared
r2_value <- cor_result$estimate^2
p <- cor_result$p.value
p_text <- if (p < 0.0001) {
"p < 0.0001"
} else if (p < 0.001) {
"p < 0.001"
} else if (p < 0.01) {
"p < 0.01"
} else if (p < 0.05) {
"p < 0.05"
} else {
paste0("p = ", signif(p, 3))
}
# Show result
cat("r =", round(cor_result$estimate, 3), ",", p_text)
# Create plot
pcorrelation <- ggplot(data, aes(x = Manual, y = ML)) +
geom_point(color = "steelblue", size = 2, alpha = 0.5) +
geom_smooth(method = "lm", se = TRUE, color = "darkred", linetype = "dashed") +
theme_minimal() +
theme(
axis.title.x = element_text(size = 7),
axis.title.y = element_text(size = 7)
) +
labs(
title = "Correlation Between Manual and ML Video Analysis",
subtitle = paste0(
"Pearson r = ", round(cor_result$estimate, 2),
", R² = ", round(r2_value, 2),
", ", p_text
),
x = "Manual (time sniffing at each cotton bud presentation - s)",
y = "ML (time sniffing at each cotton bud presentation - s)"
)
ggsave("tb_tdp_old_correl_corr_labels_3_r2.tiff", plot = pcorrelation, width = 5, height = 3, dpi = 600)  # Adjust width, height, and dpi as needed and save the image in the folder where the code file is
# Load required library
library(ggplot2)
setwd("~/Downloads/ML-analysis-olfaction/Figure3/")
# 1. Read the CSV file (replace with your actual file path)
data <- read.csv("odour_by_order_combined_manual2_correlation.csv")
# 3. Correlation test between column 'a' and 'b'
cor_result <- cor.test(data$Scorer1, data$Scorer2, method = "pearson")
# Compute R-squared
r2_value <- cor_result$estimate^2
p <- cor_result$p.value
p_text <- if (p < 0.0001) {
"p < 0.0001"
} else if (p < 0.001) {
"p < 0.001"
} else if (p < 0.01) {
"p < 0.01"
} else if (p < 0.05) {
"p < 0.05"
} else {
paste0("p = ", signif(p, 3))
}
# Show result
cat("r =", round(cor_result$estimate, 3), ",", p_text)
# Create plot
pcorrelation <- ggplot(data, aes(x = Manuela, y = Sevda)) +
geom_point(color = "steelblue", size = 2, alpha = 0.5) +
geom_smooth(method = "lm", se = TRUE, color = "darkred", linetype = "dashed") +
theme_minimal() +
theme(
axis.title.x = element_text(size = 7),
axis.title.y = element_text(size = 7)
) +
labs(
title = "Correlation Between Two Manual Scorers",
subtitle = paste0(
"Pearson r = ", round(cor_result$estimate, 2),
", R² = ", round(r2_value, 2),
", ", p_text
),
x = "Manual (time sniffing at each cotton bud presentation - s)",
y = "ML (time sniffing at each cotton bud presentation - s)"
)
ggsave("manual2_corr_r2.tiff", plot = pcorrelation, width = 5, height = 3, dpi = 600)  # Adjust width, height, and dpi as needed and save the image in the folder where the code file is
# Load required library
library(ggplot2)
setwd("~/Downloads/ML-analysis-olfaction/Figure3/")
# 1. Read the CSV file (replace with your actual file path)
data <- read.csv("odour_by_order_combined_manual2_correlation.csv")
# 3. Correlation test between column 'a' and 'b'
cor_result <- cor.test(data$Scorer1, data$Scorer2, method = "pearson")
# Compute R-squared
r2_value <- cor_result$estimate^2
p <- cor_result$p.value
p_text <- if (p < 0.0001) {
"p < 0.0001"
} else if (p < 0.001) {
"p < 0.001"
} else if (p < 0.01) {
"p < 0.01"
} else if (p < 0.05) {
"p < 0.05"
} else {
paste0("p = ", signif(p, 3))
}
# Show result
cat("r =", round(cor_result$estimate, 3), ",", p_text)
# Create plot
pcorrelation <- ggplot(data, aes(x = Scorer1, y = Scorer2)) +
geom_point(color = "steelblue", size = 2, alpha = 0.5) +
geom_smooth(method = "lm", se = TRUE, color = "darkred", linetype = "dashed") +
theme_minimal() +
theme(
axis.title.x = element_text(size = 7),
axis.title.y = element_text(size = 7)
) +
labs(
title = "Correlation Between Two Manual Scorers",
subtitle = paste0(
"Pearson r = ", round(cor_result$estimate, 2),
", R² = ", round(r2_value, 2),
", ", p_text
),
x = "Manual (time sniffing at each cotton bud presentation - s)",
y = "ML (time sniffing at each cotton bud presentation - s)"
)
ggsave("manual2_corr_r2.tiff", plot = pcorrelation, width = 5, height = 3, dpi = 600)  # Adjust width, height, and dpi as needed and save the image in the folder where the code file is
# Load required library
library(ggplot2)
setwd("~/Downloads/ML-analysis-olfaction/Figure3/")
# 1. Read the CSV file (replace with your actual file path)
data <- read.csv("odour_by_order_combined_manual2_correlation.csv")
# 3. Correlation test between column 'a' and 'b'
cor_result <- cor.test(data$Scorer1, data$Scorer2, method = "pearson")
# Compute R-squared
r2_value <- cor_result$estimate^2
p <- cor_result$p.value
p_text <- if (p < 0.0001) {
"p < 0.0001"
} else if (p < 0.001) {
"p < 0.001"
} else if (p < 0.01) {
"p < 0.01"
} else if (p < 0.05) {
"p < 0.05"
} else {
paste0("p = ", signif(p, 3))
}
# Show result
cat("r =", round(cor_result$estimate, 3), ",", p_text)
# Create plot
pcorrelation <- ggplot(data, aes(x = Scorer1, y = Scorer2)) +
geom_point(color = "steelblue", size = 2, alpha = 0.5) +
geom_smooth(method = "lm", se = TRUE, color = "darkred", linetype = "dashed") +
theme_minimal() +
theme(
axis.title.x = element_text(size = 7),
axis.title.y = element_text(size = 7)
) +
labs(
title = "Correlation Between Two Manual Scorers",
subtitle = paste0(
"Pearson r = ", round(cor_result$estimate, 2),
", R² = ", round(r2_value, 2),
", ", p_text
),
x = "Scorer1 (time sniffing each cotton bud presentation - s)",
y = "Scorer2 (time sniffing each cotton bud presentation - s)"
)
ggsave("manual2_corr_r2.tiff", plot = pcorrelation, width = 5, height = 3, dpi = 600)  # Adjust width, height, and dpi as needed and save the image in the folder where the code file is
library(ggplot2)
library(readr)
library(dplyr)
#this is a test
setwd("~/Downloads/ML-analysis-olfaction/ML-analysis-olfaction/Figure4")
library(ggplot2)
library(readr)
library(dplyr)
#this is a test
setwd("~/D/ML-analysis-olfaction/Figure4")
library(ggplot2)
library(readr)
library(dplyr)
#this is a test
setwd("~/Downloads/ML-analysis-olfaction/Figure4")
# read in data
data_mouse_C9 <- read_csv("C9_all.csv")
data_mouse_TDP43 <- read_csv("TDP_all.csv")
ggplot(data_mouse_C9, aes(x = Filtered, fill = Source)) +
geom_bar(stat = "count", position = position_dodge(width = 0.9)) +
facet_wrap(~ Age, ncol = 2) +   scale_fill_manual(values = c("#66CDAA", "#8279D6"), labels = c("Manual","ML"))+
ggtitle(expression("WT and " * italic("C9orf72")^italic("GR400/+") * "mice"))
theme_minimal()
ggsave("C9_hist.tiff")  # Adjust width, height, and dpi as needed and save as an image in the folder where the code file is
ggplot(data_mouse_TDP43, aes(x = Filtered, fill = Source)) +
geom_bar(stat = "count", position = position_dodge(width = 0.9)) +
facet_wrap(~ Age, ncol = 2) + scale_fill_manual(values = c("#FFB366", "#80DFFF"), labels = c("Manual","ML")) +
ggtitle(expression("WT and " * italic("Tardbp")^italic("Q331K/Q331K") * "mice"))
theme_minimal()
ggsave("TDP43_hist.tiff")  # Adjust width, height, and dpi as needed and save as an image in the folder where the code file is
library(car)
library(DHARMa)
library(lmerTest)
library(emmeans)
# read in data
data_mouse <- read_csv("C9_nonfiltered_status.csv", col_types = cols (
mouse_id = 'f',
Odour_presentation = 'f',
Sex = 'f',
Source = 'f',
Genotype = 'f',
Odour_type_presentation = 'f'
))
#relevel the data to compare everything in the model to control mice
data_mouse$Source <- relevel(data_mouse$Source, ref = "Manual")
#linear mixed effects model
ME_EXPL<- glmer(Status~ Source*Age + (1|mouse_id),data = data_mouse, family = binomial)
summary(ME_EXPL)
car::Anova(ME_EXPL, type = "III", test.statistic = "Chisq")
#post-hoc exploring olfactory habituation-dishabituation
#smell/ habituation comparison by genotype
#emmeans(ME_EXPL, list(pairwise ~ Source*Age), adjust = "bonferroni")
# DHARMa diagnostics
sim_res <- simulateResiduals(ME_EXPL, n = 1000)
plot(sim_res)
# Additional diagnostics
testDispersion(sim_res)
testZeroInflation(sim_res)
testUniformity(sim_res)
library(car)
library(DHARMa)
library(lmerTest)
library(emmeans)
# read in data
data_mouse <- read_csv("TDP_nonfiltered_status.csv", col_types = cols (
mouse_id = 'f',
Age = 'f',
Odour_presentation = 'f',
Sex = 'f',
Source = 'f',
Genotype = 'f',
Odour_type_presentation = 'f'
))
#relevel the data to compare everything in the model to control mice
data_mouse$Source <- relevel(data_mouse$Source, ref = "Manual")
#linear mixed effects model
ME_EXPL<- glmer(Status~ Source*Age + (1|mouse_id),data = data_mouse, family = binomial)
summary(ME_EXPL)
car::Anova(ME_EXPL, type = "III", test.statistic = "Chisq")
# DHARMa diagnostics
sim_res <- simulateResiduals(ME_EXPL, n = 1000)
plot(sim_res)
# Additional diagnostics
testDispersion(sim_res)
testZeroInflation(sim_res)
testUniformity(sim_res)
#post-hoc exploring olfactory habituation-dishabituation
#smell/ habituation comparison by genotype
emm <- emmeans(ME_EXPL, ~Source*Age)
str(emm)
coef_t_freq <- coef(pairs(emm))
custom_contrasts <- list("Man vs ML 15" = c(1, -1, 0, 0),
"Man vs ML 67" = c(0, 0, 1, -1)
)
specific_comparisons <-contrast(emm, custom_contrasts)
summary_comparisons <- summary(specific_comparisons, adjust="bonferroni")
print(summary_comparisons)
