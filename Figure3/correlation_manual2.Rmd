---
title: "Untitled"
output: html_document
date: "2025-04-15"
----

```{r}
# Load required library
library(ggplot2)
setwd("~/Downloads/ML-analysis-olfaction/Figure3/")

# 1. Read the CSV file (replace with your actual file path)
data <- read.csv("odour_by_order_combined_manual2_correlation.csv")

# 3. Correlation test between column 'a' and 'b'
cor_result <- cor.test(data$Scorer1, data$Scorer2, method = "pearson")
# Compute R-squared
r2_value <- cor_result$estimate^2
p <- cor_result$p.value

p_text <- if (p < 0.0001) {
  "p < 0.0001"
} else if (p < 0.001) {
  "p < 0.001"
} else if (p < 0.01) {
  "p < 0.01"
} else if (p < 0.05) {
  "p < 0.05"
} else {
  paste0("p = ", signif(p, 3))
}

# Show result
cat("r =", round(cor_result$estimate, 3), ",", p_text)

# Create plot
pcorrelation <- ggplot(data, aes(x = Scorer1, y = Scorer2)) +
  geom_point(color = "steelblue", size = 2, alpha = 0.5) +
  geom_smooth(method = "lm", se = TRUE, color = "darkred", linetype = "dashed") +
  theme_minimal() +
  theme(
    axis.title.x = element_text(size = 7),
    axis.title.y = element_text(size = 7)
  ) +
  labs(
    title = "Correlation Between Two Manual Scorers",
    subtitle = paste0(
      "Pearson r = ", round(cor_result$estimate, 2),
      ", RÂ² = ", round(r2_value, 2),
       ", ", p_text
    ),
    x = "Scorer1 (time sniffing each cotton bud presentation - s)",
    y = "Scorer2 (time sniffing each cotton bud presentation - s)"
  )

       
ggsave("manual2_corr_r2.tiff", plot = pcorrelation, width = 5, height = 3, dpi = 600)  # Adjust width, height, and dpi as needed and save the image in the folder where the code file is

```

